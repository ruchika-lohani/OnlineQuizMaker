{% extends 'base.html' %}

{% block content %}
<div class="container">
    <div class="header-section">
        <h2>Add Questions to: {{ quiz.title }}</h2>
        <div class="quiz-info">
            <p><strong>Current Questions:</strong> {{ questions.count }}</p>
            <form action="{% url 'delete_quiz' quiz.id %}" method="post" class="d-inline">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this entire quiz? This will delete all questions too!')">Delete Entire Quiz</button>
            </form>
        </div>
    </div>

    <!-- Add Question Form -->
    <div class="add-question-form">
        <h3>Add New Question</h3>
        <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="btn btn-primary">Add Question</button>
        </form>
    </div>

    <!-- Existing Questions -->
    {% if questions %}
    <div class="existing-questions">
        <h3>Existing Questions ({{ questions.count }})</h3>
        <div class="questions-list">
            {% for question in questions %}
            <div class="question-card">
                <div class="question-header">
                    <h4>Question {{ forloop.counter }}</h4>
                    <form action="{% url 'delete_question' question.id %}" method="post" class="d-inline">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this question?')">Delete</button>
                    </form>
                </div>
                <p><strong>Question:</strong> {{ question.question_text }}</p>
                <p><strong>Options:</strong></p>
                <ol>
                    <li>{{ question.option1 }}</li>
                    <li>{{ question.option2 }}</li>
                    <li>{{ question.option3 }}</li>
                    <li>{{ question.option4 }}</li>
                </ol>
                <p><strong>Correct Answer:</strong> Option {{ question.correct_option }}</p>
                {% if question.explanation %}
                <p><strong>Explanation:</strong> {{ question.explanation }}</p>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
    {% else %}
    <div class="no-questions">
        <p>No questions added yet. Add your first question above!</p>
    </div>
    {% endif %}

    <div class="navigation-actions">
        <a href="{% url 'my_quizzes' %}" class="btn btn-secondary">Back to My Quizzes</a>
        {% if questions.count > 0 %}
        <a href="{% url 'take_quiz' quiz.id %}" class="btn btn-success">Take This Quiz</a>
        {% endif %}
    </div>
</div>

<style>
.header-section {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
}

.quiz-info {
    text-align: right;
}

.add-question-form {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 30px;
}

.questions-list {
    display: grid;
    gap: 15px;
    margin-top: 15px;
}

.question-card {
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 15px;
    background: white;
}

.question-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.btn-sm {
    padding: 4px 8px;
    font-size: 12px;
}

.navigation-actions {
    margin-top: 30px;
    display: flex;
    gap: 10px;
}

.btn-success {
    background: #28a745;
    color: white;
}
</style>
{% endblock %}